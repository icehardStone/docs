# 关于linux 基本信息问题

## linux 系统的启动过程

操作系统的启动过程简单分为四个部分，从BIOS自检，系统引导，启动内核，初始化系统，其中每个部分又分为多个子部分，操作系统的建立是一个相对比较复杂的事情。

* BIOS自检
* 系统引导
* 启动内核
* 解压内核

### BIOS自检

在计算机开机时，boot被自动执行，指引CPU把操作系统从大容量存储器中传送到主存储器的易失区。BIOS的功能由两部分组成，分别是POST码和Runtime 服务。POST阶段完成后，他将从存储器中被清除，而Runtime 服务会被一直保留，用于操作系统的启动

### 系统引导

引导程序的核心工作是将linux内核从外存读入内存，并将其放在合适的位置中。linux的内核被分为三部分

1.主体部分是在保护模式或64位中运行的内核镜像，已经被压缩
2.在内核镜像之前有一段解压缩程序用于接压缩内核
3.文件头部是一段实模式的初始化程序，用于在实模式运行

同时为了缩减内核规模，实现内核的灵活性和适应性，内核被分为两部分：基础部分和扩展部分。
基本内核实现内核最基本的管理功能，不随计算机的变化而变化；扩展功能实现内核一些独立的模块（如驱动和文件系统），会发生变化，被放在initrd中，需要引导程序一并读入，。

### 启动内核

当处理器离开程序的时候，他处于实模式下面，需要执行实模式下面的引导程序后，跳转到保护模式解压缩内核镜像；

在实模式中，引导程序进行三项工作

1.手机系统参数
2.设置基本环境
3.切换处理器操作模式

### 解压内核

如前面讲的，linux 在内存中未内存镜像，需要进行解压缩，解压缩后需要把内核放在适当的位置。这个位置在老的版本中为0x100000处，新版本要求物理内存的0x1000000存，这样可以节省16MB一下的内存空间给DMA使用，借此就进入了保护模式的内核初始化下了。

## linux 文件类型

### 普通文件

ls -l
第一个字符为 - 的文件为普通文件

### 目录文件

ls -l 第一个字符为 d 的文件为目录文件

### 链接文件

1.硬链接和软链接

ls -l 第一个字符为 l 的文件为链接文件

### 设备文件

linux 中的硬件设备为硬盘，鼠标等也都被表示为文件，即设备文件，设备文件一般存放在/dev/目录下

（1）块设备文件

块设备文件支持以block 为单位的访问方式。
使用ls -l 命令查看，块设备文件的第一个字符为b

（2）字符设备文件

字符设备文件以字节流的方式进行访问，由字符设备驱动程序来实现这种特性。通常用到open,close,read,write等系统调用。

### 管道文件（FIFO文件）

管道文件主要用不进程间通信，使用ls -l命令查看，第一个字符为p

## CentOS7开机自启动

### 方法一 rc.local

因为在CentOS7中/etc/rc.d/rc.local的权限被降低了，所以需要赋予其可执行权

chmod  +x  /usr/local/script/autostart.sh
打开/etc/rc.d/rc.local文件在末尾增加以下内容

/usr/local/script/autostart.sh

### 方法二 chkconfig

1、将脚本移动到/etc/rc.d/init.d目录下

mv  /usr/local/script/autostart.sh /etc/rc.d/init.d
2、增加脚本的可执行权限

chmod +x  /etc/rc.d/init.d/autostart.sh
3、添加脚本到开机自动启动项目中

cd /etc/rc.d/init.d
chkconfig --add autostart.sh
chkconfig autostart.sh on

chkconfig启动脚本规范 在脚本开头加入下面内容：

``` shell
#!/bin/sh
#chkconfig:2345 80 90
#decription:autostart
#说明：chkonfig后面是启动级别和优先级，description后面是服务描述。如上面脚本意思是，
#服务必须在运行级2，3，4，5下被启动或关闭，启动的优先级是90，停止的优先级是10。
#优先级范围是0－100，数字越大，优先级越低。
#注意：不添加以上内容的话添加启动项时会提示service myservice does not support chkconfig
```
